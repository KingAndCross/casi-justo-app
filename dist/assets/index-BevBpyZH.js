(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function p(t,e,n=!1){let o=5;const r=n?1:0;for(let s=0;s<e.length;s++)for(let c=s+r;c<e.length;c++){const a=e[s]*e[c],i=Math.abs(t-a);if(i===0)return 0;i<o&&(o=i)}return o}function v(t,e){return Math.floor(Math.random()*(e-t))+t}function g(t=0,e=1){const n=1-Math.random(),o=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*o)*e+t}function O(t,e){const[n,o]=e,r=Math.round(t);return r<n?n:r>o?o:r}function b(t){t.classList.add("animate"),t.addEventListener("animationend",()=>{t.classList.remove("animate")},{once:!0})}function L(t=!1){const n=window.location.href.split("?");return t&&history.replaceState(null,"",n[0]),n[1]||""}function T(t){return t.split("+").map(o=>o.split("."))}function x(){const t=["default-theme","ice-theme","watermelon-theme","neon-theme"],n=(t.indexOf(document.body.className)+1)%t.length;document.body.className=t[n]}function N(t){const{numberToFocusOn:e,focusStrength:n,targetRange:o}=t,r=e[Math.floor(Math.random()*e.length)],s=g(r,n);return O(s,o)}function l(t){const{gameSettings:e}=t,{activeButtonsValues:n}=t.sessionData,{targetRange:o,numberToFocusOn:r,singleUse:s}=e;let c=v(...o);Object.is(r,null)||(c=N(e));let a=p(c,n,s);return[c,a]}function h(t){const{gameSettings:e}=t,{targetElement:n}=t.DOMElements,{targetNumbers:o}=e;let r=1e3,[s,c]=l(t);if(o==="exact-results")for(;c!=0||r===0;)[s,c]=l(t),r-=1;else if(o==="non-exact-results")for(;c===0||r===0;)[s,c]=l(t),r-=1;const a=n.querySelector(".target-number");a.innerHTML=`<p>${s}</p>`,t.sessionData.currTarget=s}function q(t,e){const{newgameButtons:n}=t.DOMElements;n.forEach(o=>{o.addEventListener("click",()=>{o.parentElement.parentElement.close(),e(t)})})}function A(t,e){t.textContent=`${e}`,b(t)}function P(t,e){const{numberButtons:n}=t.DOMElements;n.forEach(r=>{const{inputNumbers:s}=t.DOMElements;r.addEventListener("click",()=>{const c=parseInt(r.value),{currentInputIndex:a}=t.sessionData,i=s[a];A(i,c),t.sessionData.currProduct*=c,t.gameSettings.singleUse&&(r.disabled=!0),t.sessionData.currentInputIndex+=1,t.sessionData.currentInputIndex>=2&&(C(t),Q(t),e(t))})})}function B(t,e,n){const{resetButton:o}=t.DOMElements;q(t,e),P(t,n),o.addEventListener("click",()=>{d(t),m(t)})}function R(t){const{currProduct:e,currTarget:n,activeButtonsValues:o}=t.sessionData,{singleUse:r}=t.gameSettings,s=Math.abs(e-n),c=p(n,o,r),a=s-c;return{points:a>5?5:a,smallestDifference:c}}function w(t){const{gameoverModal:e}=t.DOMElements,{totalPoints:n,minimalPossibleTotalPoints:o}=t.sessionData,r=e.querySelector(".gameover-text");r.innerHTML=`Obtuviste ${n} puntos, el puntaje m√°s bajo posible era ${o}.`}function G(t,e){const{targetElement:n}=e,o=n.querySelector(".added-points");t===0&&o.classList.add("perfect"),o.innerHTML=`<p>+${t}</p>`,n.classList.add("animate"),n.addEventListener("animationend",()=>{n.classList.remove("animate"),o.classList.remove("perfect")},{once:!0})}function k(t,e){const{gameSettings:n}=t,{round:o}=t.sessionData;d(t),m(t),o<n.numberOfRounds-1?(F(t),h(t)):e(t)}function C(t){const{currProduct:e}=t.sessionData,{multiplicationResult:n}=t.DOMElements;n.innerText=e.toString(),b(n)}function _(t){const{round:e,lastAddedPoints:n}=t.sessionData,{roundIndicatorContainer:o}=t.DOMElements,r=o.querySelectorAll(".indicator");n===0&&r[e].classList.add("perfect"),r[e].classList.add("done")}function F(t){_(t),t.sessionData.round+=1}function d(t){return t.DOMElements.inputNumbers.forEach(e=>e.textContent=""),t.sessionData.currentInputIndex=0,t.sessionData.currProduct=1,t}function D(t,e){const{timerElement:n}=t.DOMElements,{timerID:o}=t.sessionData,{gameSettings:r}=t;clearTimeout(o),n.setAttribute("style",`--duration: ${r.time}s`),n.style.animationName="none",n.offsetWidth,n.style.animationName="timer",t.sessionData.timerID=setTimeout(()=>{e(t)},r.time*1e3)}function H(t){const{roundIndicatorContainer:e}=t;e.querySelectorAll(".indicator").forEach(o=>o.classList.remove("done"))}function V(t){t.sessionData.activeButtonsValues=y()}function y(){const t=document.querySelectorAll(".number-btn:not([disabled])");return Array.from(t).map(e=>parseInt(e.value))}function m(t){const{numberButtons:e}=t.DOMElements,{disabledNumbers:n}=t.gameSettings;e.forEach(r=>{r.disabled=n.includes(parseInt(r.value))})}function U(t){const{roundIndicatorContainer:e}=t.DOMElements,n="<div class='indicator'></div>".repeat(t.gameSettings.numberOfRounds);e.innerHTML=n}function $(t){const{currentActivityIndex:e}=t,{activitySequence:n}=t;n!==null&&e!==null&&e<n.length-1&&(t.currentActivityIndex+=1,t.gameSettings=n[t.currentActivityIndex])}function j(){const t=document.querySelector(".multiplication-result"),e=document.querySelectorAll(".input-number"),n=document.querySelectorAll(".number-btn"),o=document.querySelector(".reset-btn"),r=document.querySelector(".target-container"),s=document.querySelectorAll(".newgame-btn"),c=document.getElementById("gameover-modal"),a=document.querySelector(".timer"),i=document.querySelector(".rounds-indicators"),E=[r,a,o,i,t],I=[n,e,s];if(E.some(u=>!(u instanceof HTMLElement)))throw new Error("One or more HTMLElements are not in the DOM");if(I.some(u=>!(u instanceof NodeList)))throw new Error("One or more NodeList are not in the DOM");return{multiplicationResult:t,targetElement:r,timerElement:a,resetButton:o,roundIndicatorContainer:i,numberButtons:n,inputNumbers:e,newgameButtons:s,gameoverModal:c}}function M(){return{round:0,currentInputIndex:0,currProduct:1,currTarget:1,lastAddedPoints:0,totalPoints:0,minimalPossibleTotalPoints:0,timerID:void 0,delay:300,activeButtonsValues:y()}}function z(){document.getElementById("instructions-modal").showModal()}function W(t){let e={sessionData:M(),DOMElements:j(),gameSettings:t[0],activitySequence:t,currentActivityIndex:0,firstGame:!0};return B(e,K,f),e}function K(t){t.sessionData=M(),t.firstGame||($(t),x()),t.firstGame=!1,U(t),H(t.DOMElements),m(t),V(t),D(t,f),d(t),h(t),console.log(t.gameSettings)}function f(t){D(t,f),setTimeout(()=>{k(t,J)},t.sessionData.delay)}function Q(t){const{points:e,smallestDifference:n}=R(t);t.sessionData.lastAddedPoints=e,t.sessionData.minimalPossibleTotalPoints+=n,G(e,t.DOMElements)}function J(t){const{gameoverModal:e,timerElement:n}=t.DOMElements,{timerID:o}=t.sessionData;w(t),e.showModal(),clearTimeout(o),n.style.visibility="hidden",n.style.animationName="none",n.offsetWidth}function X(){return{numberOfRounds:5,time:15,targetRange:[10,144],disabledNumbers:[],singleUse:!1,targetNumbers:"all",numberToFocusOn:null,focusStrength:1,timeFunction:"constant",resultFeedback:!1}}function Y(t,e){switch(t){case"low-numbers":e.targetRange=[10,50];break;case"high-numbers":e.targetRange=[50,144];break;case"fast-pace":e.time=8;break;case"thirt-fifties-focus":e.numberToFocusOn=[30,50];break;case"all-off":e.targetNumbers="non-exact-results";break;case"the-tables":e.targetNumbers="exact-results";break;case"the-hard-tables":e.disabledNumbers=[1,2,5,10];break}return e}function Z(t){let e=X();for(const n of t)e=Y(n,e);return e}function S(){const t=L(),e=T(t);let n=[];for(const o of e)n.push(Z(o));return n}document.addEventListener("DOMContentLoaded",()=>{const t=S();W(t),z()});
