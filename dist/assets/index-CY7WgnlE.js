(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}})();function h(t,e,n=!1){let r=5;const o=n?1:0;for(let s=0;s<e.length;s++)for(let c=s+o;c<e.length;c++){const a=e[s]*e[c],u=Math.abs(t-a);if(u===0)return 0;u<r&&(r=u)}return r}function g(t,e){return Math.floor(Math.random()*(e-t))+t}function L(t=0,e=1){const n=1-Math.random(),r=Math.random();return Math.sqrt(-2*Math.log(n))*Math.cos(2*Math.PI*r)*e+t}function T(t,e){const[n,r]=e,o=Math.round(t);return o<n?n:o>r?r:o}function y(t){t.classList.add("animate"),t.addEventListener("animationend",()=>{t.classList.remove("animate")},{once:!0})}function x(t=!1){const n=window.location.href.split("?");return t&&history.replaceState(null,"",n[0]),n[1]||""}function N(t){return t.split("+").map(r=>r.split("."))}function q(){const t=["default-theme","ice-theme","watermelon-theme","neon-theme"],n=(t.indexOf(document.body.className)+1)%t.length;document.body.className=t[n]}function b(t=!0){if(!t){document.body.style.pointerEvents="auto";return}document.body.style.pointerEvents="none"}function A(t){const{numberToFocusOn:e,focusStrength:n,targetRange:r}=t,o=e[Math.floor(Math.random()*e.length)],s=L(o,n);return T(s,r)}function l(t){const{gameSettings:e}=t,{activeButtonsValues:n}=t.sessionData,{targetRange:r,numberToFocusOn:o,singleUse:s}=e;let c=g(...r);Object.is(o,null)||(c=A(e));let a=h(c,n,s);return[c,a]}function D(t){const{gameSettings:e}=t,{targetElement:n}=t.DOMElements,{targetNumbers:r}=e;let o=1e3,[s,c]=l(t);if(r==="exact-results")for(;c!=0||o===0;)[s,c]=l(t),o-=1;else if(r==="non-exact-results")for(;c===0||o===0;)[s,c]=l(t),o-=1;const a=n.querySelector(".target-number");a.innerHTML=`<p>${s}</p>`,t.sessionData.currTarget=s}function B(t,e){const{newgameButtons:n}=t.DOMElements;n.forEach(r=>{r.addEventListener("click",()=>{r.parentElement.parentElement.close(),e(t)})})}function R(t,e){t.textContent=`${e}`,y(t)}function w(t,e){const{numberButtons:n}=t.DOMElements;n.forEach(o=>{const{inputNumbers:s}=t.DOMElements;o.addEventListener("click",()=>{const c=parseInt(o.value),{currentInputIndex:a}=t.sessionData,u=s[a];R(u,c),t.sessionData.currProduct*=c,t.gameSettings.singleUse&&(o.disabled=!0),t.sessionData.currentInputIndex+=1,t.sessionData.currentInputIndex>=2&&(F(t),J(t),e(t))})})}function P(t,e,n){const{resetButton:r}=t.DOMElements;B(t,e),w(t,n),r.addEventListener("click",()=>{d(t),m(t)})}function k(t){const{currProduct:e,currTarget:n,activeButtonsValues:r}=t.sessionData,{singleUse:o}=t.gameSettings,s=Math.abs(e-n),c=h(n,r,o),a=s-c;return{points:a>5?5:a,smallestDifference:c}}function C(t){const{gameoverModal:e}=t.DOMElements,{totalPoints:n}=t.sessionData,r=e.querySelector(".gameover-text");r.innerHTML=`Â¡Obtuviste ${n} puntos! (recuerda, entre menos mejor!) Sigue a la siguiente ronda.`}function G(t,e){const{targetElement:n}=e,r=n.querySelector(".added-points");t===0&&r.classList.add("perfect"),r.innerHTML=`<p>+${t}</p>`,n.classList.add("animate"),n.addEventListener("animationend",()=>{n.classList.remove("animate"),r.classList.remove("perfect")},{once:!0})}function _(t,e){const{gameSettings:n}=t,{round:r}=t.sessionData;d(t),m(t),r<n.numberOfRounds-1?(p(t),D(t)):(p(t),e(t))}function F(t){const{currProduct:e}=t.sessionData,{multiplicationResult:n}=t.DOMElements;n.innerText=e.toString(),y(n)}function H(t){const{round:e,lastAddedPoints:n}=t.sessionData,{roundIndicatorContainer:r}=t.DOMElements,o=r.querySelectorAll(".indicator");n===0&&o[e].classList.add("perfect"),o[e].classList.add("done")}function p(t){H(t),t.sessionData.round+=1}function d(t){return t.DOMElements.inputNumbers.forEach(e=>e.textContent=""),t.sessionData.currentInputIndex=0,t.sessionData.currProduct=1,t}function M(t,e){const{timerElement:n}=t.DOMElements,{timerID:r}=t.sessionData,{gameSettings:o}=t;clearTimeout(r),n.setAttribute("style",`--duration: ${o.time}s`),n.style.animationName="none",n.offsetWidth,n.style.animationName="timer",t.sessionData.timerID=setTimeout(()=>{e(t)},o.time*1e3)}function U(t){const{roundIndicatorContainer:e}=t;e.querySelectorAll(".indicator").forEach(r=>r.classList.remove("done"))}function V(t){t.sessionData.activeButtonsValues=E()}function E(){const t=document.querySelectorAll(".number-btn:not([disabled])");return Array.from(t).map(e=>parseInt(e.value))}function m(t){const{numberButtons:e}=t.DOMElements,{disabledNumbers:n}=t.gameSettings;e.forEach(o=>{o.disabled=n.includes(parseInt(o.value))})}function $(t){const{roundIndicatorContainer:e}=t.DOMElements,n="<div class='indicator'></div>".repeat(t.gameSettings.numberOfRounds);e.innerHTML=n}function j(t){const{currentActivityIndex:e}=t,{activitySequence:n}=t;n!==null&&e!==null&&e<n.length-1&&(t.currentActivityIndex+=1,t.gameSettings=n[t.currentActivityIndex])}function z(){const t=document.querySelector(".multiplication-result"),e=document.querySelectorAll(".input-number"),n=document.querySelectorAll(".number-btn"),r=document.querySelector(".reset-btn"),o=document.querySelector(".target-container"),s=document.querySelectorAll(".newgame-btn"),c=document.getElementById("gameover-modal"),a=document.querySelector(".timer"),u=document.querySelector(".rounds-indicators"),I=[o,a,r,u,t],O=[n,e,s];if(I.some(i=>!(i instanceof HTMLElement)))throw new Error("One or more HTMLElements are not in the DOM");if(O.some(i=>!(i instanceof NodeList)))throw new Error("One or more NodeList are not in the DOM");return{multiplicationResult:t,targetElement:o,timerElement:a,resetButton:r,roundIndicatorContainer:u,numberButtons:n,inputNumbers:e,newgameButtons:s,gameoverModal:c}}function v(){return{round:0,currentInputIndex:0,currProduct:1,currTarget:1,lastAddedPoints:0,totalPoints:0,minimalPossibleTotalPoints:0,timerID:void 0,delay:300,activeButtonsValues:E()}}function W(){document.getElementById("instructions-modal").showModal()}function K(t){let e={sessionData:v(),DOMElements:z(),gameSettings:t[0],activitySequence:t,currentActivityIndex:0,firstGame:!0};return P(e,Q,f),e}function Q(t){t.sessionData=v(),t.firstGame||(j(t),q()),t.firstGame=!1,$(t),U(t.DOMElements),m(t),V(t),M(t,f),d(t),D(t)}function f(t){M(t,f),b(),setTimeout(()=>{_(t,X),b(!1)},t.sessionData.delay)}function J(t){const{points:e,smallestDifference:n}=k(t);t.sessionData.lastAddedPoints=e,t.sessionData.minimalPossibleTotalPoints+=n,G(e,t.DOMElements)}function X(t){const{gameoverModal:e,timerElement:n}=t.DOMElements,{timerID:r}=t.sessionData;C(t),e.showModal(),clearTimeout(r),n.style.visibility="hidden",n.style.animationName="none",n.offsetWidth}function Y(){return{numberOfRounds:5,time:15,targetRange:[10,144],disabledNumbers:[],singleUse:!1,targetNumbers:"all",numberToFocusOn:null,focusStrength:1,timeFunction:"constant",resultFeedback:!1}}function Z(t,e){switch(t){case"low-targets":e.targetRange=[10,50];break;case"high-targets":e.targetRange=[50,144];break;case"slow-pace":e.time=25;break;case"fast-pace":e.time=8;break;case"ten-rounds":e.numberOfRounds=10;break;case"thirt-fifties-focus":e.numberToFocusOn=[30,50];break;case"non-exact-targets":e.targetNumbers="non-exact-results";break;case"exact-targets":e.targetNumbers="exact-results";break;case"non-easy-factors":e.disabledNumbers=[1,2,5,10];break;case"non-hard-factors":e.disabledNumbers=[6,7,8,12];break;case"non-squares":e.singleUse=!0;break}return e}function S(t){let e=Y();for(const n of t)e=Z(n,e);return e}function tt(){const t=x(),e=N(t);let n=[];for(const r of e)n.push(S(r));return n}document.addEventListener("DOMContentLoaded",()=>{const t=tt();K(t),W()});
